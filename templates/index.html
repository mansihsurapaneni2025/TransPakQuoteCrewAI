{% extends "base.html" %}

{% block extra_css %}
<style>
    .form-label {
        color: var(--neutral-700);
        font-weight: 500;
    }
    
    .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(164, 30, 33, 0.25);
    }
    
    .form-select:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(164, 30, 33, 0.25);
    }
    
    .form-text {
        color: var(--neutral-500);
    }
    
    .card-title {
        color: var(--neutral-800);
    }
    
    .text-muted {
        color: var(--neutral-500) !important;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Main Content -->
    <div class="container mt-4">
        <div class="row">
            <div class="col-lg-6">
                <!-- Flash Messages -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-{{ 'danger' if category == 'error' else 'info' }} alert-dismissible fade show" role="alert">
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                <!-- Main Form Card -->
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title mb-0">
                            <i class="fas fa-clipboard-list me-2"></i>
                            Shipment Information
                        </h4>
                        <small class="text-muted">
                            Our AI agents will analyze your shipment and generate a comprehensive quote
                        </small>
                    </div>
                    <div class="card-body">
                        <form method="POST" action="{{ url_for('generate_quote') }}" id="quoteForm">
                            <div class="row">
                                <!-- Item Description -->
                                <div class="col-md-12 mb-3">
                                    <label for="item_description" class="form-label">
                                        <i class="fas fa-box me-1"></i>
                                        Item Description *
                                    </label>
                                    <textarea class="form-control" id="item_description" name="item_description" 
                                            rows="3" placeholder="Detailed description of the item(s) to be shipped"
                                            required>{{ form_data.item_description if form_data else '' }}</textarea>
                                    <div class="form-text">Include material, condition, and any special characteristics</div>
                                </div>

                                <!-- Dimensions -->
                                <div class="col-md-6 mb-3">
                                    <label for="dimensions" class="form-label">
                                        <i class="fas fa-ruler-combined me-1"></i>
                                        Dimensions (L x W x H) *
                                    </label>
                                    <input type="text" class="form-control" id="dimensions" name="dimensions" 
                                           placeholder="e.g., 48 x 36 x 24 inches" required
                                           value="{{ form_data.dimensions if form_data else '' }}">
                                    <div class="form-text">Include units (inches, cm, feet, etc.)</div>
                                </div>

                                <!-- Weight -->
                                <div class="col-md-6 mb-3">
                                    <label for="weight" class="form-label">
                                        <i class="fas fa-weight-hanging me-1"></i>
                                        Weight *
                                    </label>
                                    <input type="text" class="form-control" id="weight" name="weight" 
                                           placeholder="e.g., 500 lbs, 227 kg" required
                                           value="{{ form_data.weight if form_data else '' }}">
                                    <div class="form-text">Include units (lbs, kg, tons, etc.)</div>
                                </div>

                                <!-- Origin -->
                                <div class="col-md-6 mb-3">
                                    <label for="origin" class="form-label">
                                        <i class="fas fa-map-marker-alt me-1"></i>
                                        Origin Location *
                                    </label>
                                    <input type="text" class="form-control" id="origin" name="origin" 
                                           placeholder="City, State/Province, Country" required
                                           value="{{ form_data.origin if form_data else '' }}">
                                    <div class="form-text">Where the shipment will be picked up</div>
                                </div>

                                <!-- Destination -->
                                <div class="col-md-6 mb-3">
                                    <label for="destination" class="form-label">
                                        <i class="fas fa-flag-checkered me-1"></i>
                                        Destination *
                                    </label>
                                    <input type="text" class="form-control" id="destination" name="destination" 
                                           placeholder="City, State/Province, Country" required
                                           value="{{ form_data.destination if form_data else '' }}">
                                    <div class="form-text">Final delivery location</div>
                                </div>

                                <!-- Special Requirements -->
                                <div class="col-md-12 mb-3">
                                    <label for="special_requirements" class="form-label">
                                        <i class="fas fa-exclamation-triangle me-1"></i>
                                        Special Requirements
                                    </label>
                                    <textarea class="form-control" id="special_requirements" name="special_requirements" 
                                            rows="2" placeholder="Temperature control, fragile handling, insurance requirements, etc.">{{ form_data.special_requirements if form_data else '' }}</textarea>
                                    <div class="form-text">Optional: Any special handling or shipping requirements</div>
                                </div>

                                <!-- Timeline -->
                                <div class="col-md-6 mb-3">
                                    <label for="timeline" class="form-label">
                                        <i class="fas fa-clock me-1"></i>
                                        Preferred Timeline
                                    </label>
                                    <select class="form-select" id="timeline" name="timeline">
                                        <option value="">Select timeline...</option>
                                        <option value="urgent" {{ 'selected' if form_data and form_data.timeline == 'urgent' else '' }}>Urgent (1-3 days)</option>
                                        <option value="standard" {{ 'selected' if form_data and form_data.timeline == 'standard' else '' }}>Standard (1-2 weeks)</option>
                                        <option value="economy" {{ 'selected' if form_data and form_data.timeline == 'economy' else '' }}>Economy (2-4 weeks)</option>
                                        <option value="flexible" {{ 'selected' if form_data and form_data.timeline == 'flexible' else '' }}>Flexible</option>
                                    </select>
                                    <div class="form-text">How quickly do you need this shipped?</div>
                                </div>

                                <!-- Budget Range -->
                                <div class="col-md-6 mb-3">
                                    <label for="budget_range" class="form-label">
                                        <i class="fas fa-dollar-sign me-1"></i>
                                        Budget Range
                                    </label>
                                    <select class="form-select" id="budget_range" name="budget_range">
                                        <option value="">Select budget range...</option>
                                        <option value="under_1000" {{ 'selected' if form_data and form_data.budget_range == 'under_1000' else '' }}>Under $1,000</option>
                                        <option value="1000_5000" {{ 'selected' if form_data and form_data.budget_range == '1000_5000' else '' }}>$1,000 - $5,000</option>
                                        <option value="5000_15000" {{ 'selected' if form_data and form_data.budget_range == '5000_15000' else '' }}>$5,000 - $15,000</option>
                                        <option value="15000_plus" {{ 'selected' if form_data and form_data.budget_range == '15000_plus' else '' }}>$15,000+</option>
                                        <option value="no_limit" {{ 'selected' if form_data and form_data.budget_range == 'no_limit' else '' }}>No specific limit</option>
                                    </select>
                                    <div class="form-text">Optional: Helps us provide appropriate options</div>
                                </div>
                            </div>

                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-cogs me-2"></i>
                                    Generate AI Quote
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Right Side - Info Panel -->
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-info-circle me-2"></i>
                            How It Works
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-4">
                                    <div class="d-flex align-items-center mb-2">
                                        <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 32px; height: 32px;">
                                            <span class="fw-bold">1</span>
                                        </div>
                                        <h6 class="mb-0">Sales Briefing</h6>
                                    </div>
                                    <p class="text-muted small">
                                        Our AI agent analyzes your shipment details and requirements
                                    </p>
                                </div>

                                <div class="mb-4">
                                    <div class="d-flex align-items-center mb-2">
                                        <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 32px; height: 32px;">
                                            <span class="fw-bold">2</span>
                                        </div>
                                        <h6 class="mb-0">Crate Design</h6>
                                    </div>
                                    <p class="text-muted small">
                                        Custom packaging solution designed for your specific items
                                    </p>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-4">
                                    <div class="d-flex align-items-center mb-2">
                                        <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 32px; height: 32px;">
                                            <span class="fw-bold">3</span>
                                        </div>
                                        <h6 class="mb-0">Logistics Planning</h6>
                                    </div>
                                    <p class="text-muted small">
                                        Optimal shipping routes and methods determined by AI
                                    </p>
                                </div>

                                <div class="mb-4">
                                    <div class="d-flex align-items-center mb-2">
                                        <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 32px; height: 32px;">
                                            <span class="fw-bold">4</span>
                                        </div>
                                        <h6 class="mb-0">Quote Generation</h6>
                                    </div>
                                    <p class="text-muted small">
                                        Comprehensive quote with all details and pricing
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-info">
                            <i class="fas fa-lightbulb me-2"></i>
                            <strong>Pro Tip:</strong> The more detailed your description, the more accurate your quote will be. Include materials, fragility, and any special considerations.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.getElementById('quoteForm').addEventListener('submit', function(e) {
        const submitBtn = document.querySelector('button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Generating Quote...';
        submitBtn.disabled = true;
    });
</script>
{% endblock %}